---
layout: post
title: "RSA低指数攻击"
categories: crypto RSA attack python
tags: RSA attack
excerpt: 参加比赛后发现低指数攻击还没做过，做个记录。
data: 2020-10-18 21:30:00
mathjax: true
author: Eurynome
---

# 低加密指数攻击 

## 在RSA中e也称为加密指数。由于e是可以随意选取的，选取小一点的e可以缩短加密时间，但是选取不当的话，就会造成安全问题。 

### e=3时的小明文攻击 
#### 介绍： 
#### 当e=3时，如果明文过小，导致明文的三次方仍然小于n，那么通过直接对密文三次开方，即可得到明文。 
即： 
$ cequiv m^e$ $mod$ $n$ 
如果e=3，且$ m^e<{n} $，那么： 
$ c= m^e,$ $e=3$ 
$ m=sqrt[3]{c}$ 
如果明文的三次方比n大，但是不是足够大，那么设k，有： 
$ c= m^e+kn$ 
爆破k，如果$ c-kn $能开三次根式，那么可以直接得到明文。 

#### 识别： 
推荐在e=3的时候首先尝试这种方法。 

#### 例题： 

https://www.jarvisoj.com (Extremely hard RSA) 

关键代码如下：此题通过不断给明文+n开三次方即可求得： 
```
i=0
   while 1:
   if(gmpy.root(c+i*N, 3)[1]==1):
     print gmpy.root(c+i*N, 3)
     break
   i=i+1
```


### 低加密指数广播攻击 
#### 介绍： 

#### 如果选取的加密指数较低，并且使用了相同的加密指数给一个接受者的群发送相同的信息，那么可以进行广播攻击得到明文。 
即，选取了相同的加密指数e（这里取e=3），对相同的明文m进行了加密并进行了消息的传递，那么有： 
$ c_1equiv m^e$ $mod$ $n_1$ 
$ c_2equiv m^e$ $mod$ $n_2$ 
$ c_3equiv m^e$ $mod$ $n_3$ 
对上述等式运用中国剩余定理，在e=3时，可以得到： 
$ c_xequiv m^3$ $mod$ $n_1n_2n_3$ 
通过对$ c_x $进行三次开方可以求得明文。 
#### 识别： 
	这个识别起来比较简单，一般来说都是给了三组加密的参数和明密文，其中题目很明确地能告诉你这三组的明文都是一样的，并且e都取了一个较小的数字。 

#### 例题： 
SCTF2016，CODE300 
题目第二轮中通过流量包的方式给了广播攻击的参数。 
这里我就不卖萌了，直接给国外类似一题的网址：http://codezen.fr/2014/01/16/hackyou-2014-crypto-400-cryptonet